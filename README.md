# データベース体験プログラム

SQLiteを使った簡単なデータベース操作を学習できるプログラムです。

## 必要な環境

- Python 3.x（macOSには標準でインストールされています）
- 追加のライブラリは不要（標準ライブラリのみ使用）

## プログラムの概要

このプログラムは「本の管理システム」を通じて、データベースの基本操作（CRUD）を体験できます。

### CRUDとは？

- **C**reate（作成）: データベースに新しいデータを追加
- **R**ead（読み取り）: データベースからデータを取得・表示
- **U**pdate（更新）: 既存のデータを変更
- **D**elete（削除）: データを削除

## 使い方

### 1. デモモード（自動実行）

まずはデモモードで、データベースの動きを見てみましょう。

```bash
python3 book_manager.py
```

このモードでは、プログラムが自動的に以下の操作を実演します：

1. データベースの作成と接続
2. テーブルの作成
3. 本のデータを3冊追加（CREATE）
4. 全ての本を表示（READ）
5. 特定の本を検索（READ）
6. 本の情報を更新（UPDATE）
7. 本を削除（DELETE）
8. 統計情報の表示

### 2. 対話モード（手動操作）

実際に自分でデータベースを操作したい場合は、対話モードを使用します。

```bash
python3 book_manager.py -i
```

対話モードでは、以下のコマンドが使用できます：

- `1`: 本を追加
- `2`: 全ての本を表示
- `3`: 本を検索（IDで検索）
- `4`: 本の情報を更新
- `5`: 本を削除
- `6`: 統計情報を表示
- `q`: 終了

### 使用例

```
コマンドを入力 > 1
タイトル: 坊っちゃん
著者: 夏目漱石
出版年（省略可）: 1906
✓ 本を追加しました: 『坊っちゃん』 著者: 夏目漱石

コマンドを入力 > 2
======================================================================
📚 登録されている本の一覧
======================================================================
ID: 1 | 『坊っちゃん』 (1906年)
       著者: 夏目漱石 | 登録日時: 2025-10-17 10:30:45
----------------------------------------------------------------------
```

## データベースファイルについて

プログラムを実行すると、同じディレクトリに `books.db` というファイルが作成されます。
これがSQLiteのデータベースファイルで、ここにすべてのデータが保存されます。

- データベースファイルを削除すると、すべてのデータがリセットされます
- プログラムを再実行すると、既存のデータベースがあればそれを使用します

## 学習のポイント

このプログラムを通じて、以下のことを理解できます：

1. **データベースの接続**: `sqlite3.connect()` でデータベースに接続
2. **テーブルの作成**: `CREATE TABLE` でデータの構造を定義
3. **データの追加**: `INSERT INTO` で新しいレコードを追加
4. **データの取得**: `SELECT` でデータを検索・取得
5. **データの更新**: `UPDATE` で既存のデータを変更
6. **データの削除**: `DELETE` でデータを削除
7. **SQLインジェクション対策**: プレースホルダー（`?`）を使った安全なクエリ

## コードの構造

- `BookManager` クラス: データベース操作をまとめたクラス
  - `connect()`: データベースに接続
  - `create_table()`: テーブルを作成
  - `add_book()`: 本を追加
  - `show_all_books()`: 全ての本を表示
  - `find_book()`: 特定の本を検索
  - `update_book()`: 本の情報を更新
  - `delete_book()`: 本を削除
  - `count_books()`: 本の総数を取得
  - `close()`: データベース接続を閉じる

## さらに学習したい方へ

このプログラムを改造してみましょう：

- 著者名での検索機能を追加
- 出版年の範囲で検索する機能を追加
- ジャンルフィールドを追加
- 複数のテーブルを使った関連データの管理（例：著者テーブルと本テーブルを分ける）

## トラブルシューティング

### Pythonが見つからない場合

```bash
# Pythonのバージョンを確認
python3 --version

# または
python --version
```

### データベースをリセットしたい場合

```bash
# データベースファイルを削除
rm books.db
```

次回実行時に新しいデータベースが作成されます。
